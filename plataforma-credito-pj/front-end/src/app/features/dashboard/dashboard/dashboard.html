<div class="grid">
  <mat-card class="col-12">
    <div class="search">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Buscar por ID ou CNPJ</mat-label>
        <input matInput [(ngModel)]="term" (keyup.enter)="onSearch()">
        <button mat-icon-button matSuffix aria-label="buscar" (click)="onSearch()">
          <mat-icon>search</mat-icon>
        </button>
      </mat-form-field>
    </div>
  </mat-card>

  <mat-card class="col">
    <h3>Score</h3>
    <div *ngIf="scoreLoading()" class="px-2 py-2 text-sm">Carregando score...</div>
    <div *ngIf="!scoreLoading() && scoreError()" class="px-2 py-2 text-sm" style="color:#b91c1c;">{{ scoreError() }}</div>
    <ng-container *ngIf="!scoreLoading() && !scoreError()">
      <apx-chart
        [series]="scoreOpts().series"
        [chart]="scoreOpts().chart"
        [plotOptions]="scoreOpts().plotOptions"
        [labels]="scoreOpts().labels">
      </apx-chart>
      <div class="px-2 pb-2 text-sm">{{ scoreSubtitle() }}</div>
    </ng-container>
  </mat-card>

  <mat-card class="col">
    <h3>Rede Financeira</h3>
    <div
      #graph
      class="graph"
      [style.display]="hasRedeData() && !redeError() ? 'block' : 'none'">
    </div>
    <div *ngIf="redeLoading()" class="px-2 py-2 text-sm">Carregando rede...</div>
    <div *ngIf="!redeLoading() && redeError()" class="px-2 py-2 text-sm" style="color:#b91c1c;">{{ redeError() }}</div>
    <div *ngIf="!redeLoading() && !redeError() && !hasRedeData()" class="px-2 py-2 text-sm">Sem dados de rede.</div>
  </mat-card>

  <mat-card class="col">
    <h3>Macro (Historico vs Forecast)</h3>
    <div *ngIf="macroLoading()" class="px-2 py-2 text-sm">Carregando dados macro...</div>
    <div *ngIf="!macroLoading() && macroError()" class="px-2 py-2 text-sm" style="color:#b91c1c;">{{ macroError() }}</div>
    <apx-chart
      *ngIf="!macroLoading() && !macroError()"
      [series]="macro().series"
      [chart]="macro().chart"
      [xaxis]="macro().xaxis"
      [stroke]="macro().stroke"
      [dataLabels]="macro().dataLabels">
    </apx-chart>
  </mat-card>

  <mat-card class="col">
    <h3>Resumo de Decisoes</h3>
    <div *ngIf="alertasLoading()" class="px-2 py-2 text-sm">Carregando decisoes...</div>
    <div *ngIf="!alertasLoading() && alertasError()" class="px-2 py-2 text-sm" style="color:#b91c1c;">{{ alertasError() }}</div>
    <apx-chart
      *ngIf="!alertasLoading() && !alertasError()"
      [series]="alertasSeries()"
      [chart]="alertasChart"
      [xaxis]="alertasXAxis()"
      [plotOptions]="alertasPlot">
    </apx-chart>
  </mat-card>
</div>
